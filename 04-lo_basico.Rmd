# Comandos Básicos en R {#chapter_4}

## R como una Simple Calculadora^[ Para estructurar los contenidos de este capítulo, me he basado en el libro *Learning Statistics with R* escrito por Danielle Navarro.]

Una de las primeras cosas que podemos hacer para comenzar a familiarizarnos con R es usarla como si fuera una simple calculadora. De esta manera, escribiremos los primeros comandos o instrucciones y obtendremos resultados conocidos a partir de nuestra experiencia con cálculos matemáticos adquiridos durante nuestra educación primaria. Nada intimidante la verdad. En la consola de R, podemos escribir `2 + 5` y luego apretar “*enter*”. Cuando escribimos `2 + 5` lo que hicimos fue escribir un **comando** y R ejecutará dicho comando. Lo que tu vas a ver en la consola de R corresponde a: 

```{r class.source="bg-danger", class.output="bg-warning"}
2 + 5
```

Ahora bien, este simple ejemplo nos servirá para explicar algunas cosas muy simples de R. El primer bloque de arriba (es decir, `2 + 5`) corresponde al comando o instrucciones que escribimos y el bloque de abajo es el *output* o salida de R, el cual nos muestra el resultado de la suma. En este bloque, aparecen dos *hashtags* o “*signos gatos*” (como le decimos en Chile), al lado `[1] `, el cual señala el número del output producido por R (y que por cierto nosotros no escribimos, sino fue producido por R) y al lado, finalmente, aparece el resultado de la sumatoria, es decir, `7`. *So far, so good!* (¡hasta ahora todo bien!).

En la tabla 1, puedes encontrar un resumen de algunas operaciones matemáticas básicas en R. 

```{=html}    
                              <center> <h3>Tabla 1 </h3> </center>
```
              
| Operación      | Símbolo u operador | Ejemplo  | Resultado |
|:----------------:|:------------------:|:--------:|:---------:|
|      Suma      |          +         |  `3 + 6` |    `9`    |
|      Resta     |          -         |  `6 - 2` |    `4`    |
| Multiplicación |          *         |  `5 * 8` |    `40`   |
|    División    |          /         | `21 / 7` |    `3`    |
|    Potencia    |          ^         |  `2 ^ 6` |    `64`   |

## Orden de Operaciones Matemáticas en R

Habiendo presentado brevemente los símbolos matemáticos en R, cuando nos enfrentamos a situaciones donde debemos escribir diferentes cálculos, el orden de ejecución de dichas operaciones sigue el mismo orden que aprendimos durante nuestro tiempo escolar: se realiza primero lo que está dentro del paréntesis, luego potencias, para después seguir con divisiones y multiplicaciones, para finalmente terminar con sumas y restas. Abajo encontrarán tres breves ejemplos en R que ilustran estos principios. 

```{r class.source="bg-danger", class.output="bg-warning"}
5 + 5 * 12 
```
En el caso de arriba, el número `5` es multiplicado con el número `12` y luego al final se le suma el número `5` para obtener el resultado de `65`. 

```{r class.source="bg-danger", class.output="bg-warning"}
(5 + 5) * 12 
```
En este bloque, primero se suman los dos números que están al interior del paréntesis (es decir, `5 + 5 = 10`) y luego el resultado se multiplica con `12` para obtener `120`.  

```{r class.source="bg-danger", class.output="bg-warning"}
(2  ^ 3 ) / 2 
```
Al igual que el ejemplo de arriba, la operación que está dentro del paréntesis es lo que se ejecuta en primer lugar (es decir, la potencia de 2 elevada al cubo  = `2 × 2 × 2 = 8`), cuyo resultado después será dividido por `2`, lo que equivale a `4`. 

## Variables en R

Una de las principales ventajas de usar R es que podemos crear variables con el fin de almacenar información en ellas. Una manera bastante simple de entender el rol de las variables en R es que nosotros asignamos una etiqueta o un nombre a un conjunto de información determinada. La gracia de R en este caso es bastante grande: para realizar análisis de datos se necesita poder usar variables y R nos permite hacerlo de manera bastante sencilla. 

### Construyendo Variables en R

Para crear una variable, debemos utilizar el operador de asignación `<-`. Veamos un ejemplo. 

```{r class.source="bg-danger", class.output="bg-warning"}
mi_edad <- 35
```
Arriba he creado una variable que tiene por nombre o etiqueta `mi_edad` (lado izquierdo del comando) y he asignado un valor numérico a esta variable (`35`, el cual está en el lado derecho) a través del operador de asignación `<-`. Ahora, si escribo y ejecuto la variable `mi_edad`, veamos lo que pasa.
```{r class.source="bg-danger", class.output="bg-warning"}
mi_edad
```
R ha impreso el valor `35`, el cual corresponde a la operación realizada más arriba. Ahora imaginemos que deseo realizar algunas operaciones matemáticas con la variable `mi_edad`: 

```{r class.source="bg-danger", class.output="bg-warning"}
mi_edad * 5
```
```{r class.source="bg-danger", class.output="bg-warning"}
mi_edad / 5
```

```{r class.source="bg-danger", class.output="bg-warning"}
mi_edad ^  5
```
En estos tres ejemplos, podemos ver la versatilidad y sencillez de R para ejecutar operaciones matemáticas sobre una variable arbitraria. ¡Imaginen las posibilidades que nos ofrece R para interactuar de diferentes maneras con set de datos!

```{=html}
<p align="center">
  <img width="280" height="200" src="images/monkey.gif">
</p>
<p align="center">
Figura 7. Usuario inicial de R imaginando las posibilidades.
</p>
```

Incluso podemos crear nuevas variables y aplicar operaciones matemáticas entre ellas. Veamos los siguientes ejemplos. 

```{r class.source="bg-danger", class.output="bg-warning"}
mi_sueldo_al_mes <- 2000
```
```{r class.source="bg-danger", class.output="bg-warning"}
mi_sueldo_al_mes 
```

```{r class.source="bg-danger", class.output="bg-warning"}
mi_sueldo_al_mes * mi_edad
```
```{r class.source="bg-danger", class.output="bg-warning"}
mi_sueldo_al_mes + mi_edad / 10
```


Con estos sencillos ejemplos, podemos comenzar a apreciar cómo en R creamos variables (u objetos), asignándole valores numéricos con los cuales jugar y combinar para empezar a realizar análisis de datos. 

### Reglas para Nombrar Variables

R tiene posee algunas reglas generales para etiquetar o nombrar variables. A continuación, las listaré con el fin de comentarlas solo un poco porque son bastante auto explicativas. 

* Los nombres de variables usan caracteres en minúsculas y mayúsculas (R reconoce estas diferencias al momento de escribir sus variables). Se pueden incluir números en el nombre de variables, también puntos `.` o guion bajo `_` . Un nombre de variable valido es `item_empatia_1` o también `ítem.empatía.2`. El segundo ejemplo incorpora tildes, los cuales son asignados correctamente en R, aunque debemos tener cuidado que al usar tildes, debemos utilizarlas siempre para nuestro trabajo posterior. Sino, R nos dará un error. 

* Los nombres de las variables no deben incluir espacios. `mi edad` no es un nombre válido; en cambio, `mi.edad` o `mi_edad` lo son.  

* Los nombres deben empezar con una letra o con punto, pero no pueden empezar con guión bajo o con número. Por lo tanto, `_mi_edad`, `35_mi_edad`, son ejemplos inválidos en R. 

* No podemos nombrar a nuestras variables con los nombres reservados en R. Los nombres reservados de R son nombres especiales que R utiliza para realizar ciertas operaciones y que debe restringir para que no haya problemas cuando se les requiera. Los nombres reservados son: `if`, `else`, `repeat`, `while`, `function`, `for`, `in`, `next`, `break`, `TRUE`, `FALSE`, `NULL`, `Inf`, `NaN`, `NA`, `NA_integer_`, `NA_real_`, `NA_complex_` y `NA_character_`. Les recomendaría que no inviertan su tiempo en memorizarlas (de hecho, yo casi no me las sé y tuve que mirar un documento para escribirlas aquí). 

### Convenciones Informales para Nombrar Variables

A continuación, mencionaré algunas convenciones o recomendaciones informales que se tienden a utilizar en los nombres de variables en R. Si bien, obviamente, no es obligatoria seguirlas, es una buena práctica cumplir con ellas, sobretodo, si luego tu código será compartido con otras personas dentro de un flujo de trabajo. 

* Usar nombres informativos. Por ejemplo, buenos ejemplos podrían ser `edad` o `educacion` y malos ejemplos podrían ser `variable_1` o `nueva_variable` debido a que sus nombres no nos dicen nada acerca de qué se tratan dichas variables. 

* Usar nombres breves o cortos. Escribir nombres largos de variables es una “lata” y, probablemente, una pérdida de tiempo cuando estemos concentrados en realizar nuestros análisis de datos. Un ejemplo de un nombre de variable muy largo sería `edad_de_los_participantes`. Sin embargo, es difícil mantener un buen equilibrio en construir nombres informativos y significativos, sin que sean demasiado largos. Cuando llegue el momento, uno deberá tomar ciertas decisiones al respecto. 

* Ser consistente en la manera de nombrar variables. Como vimos arriba, podemos nombrar las variables con guión bajo o con puntos, cualquiera de las dos maneras está bien, pero lo más relevante es usar solo uno de ellos cuando se estén asignados el nombre a las variables en nuestro estudio. Otras personas prefieren usar mayúsculas evitando el uso de otros símbolos como por ejemplo `EdadNiños`. Por lo tanto, el mensaje central es ser consistente.

## Errores de Escritura o *typos* en R

Para interactuar con R, nuestras instrucciones y nombres de variables deben ser claras y precisas. De este modo, R podrá realizar exactamente lo que nosotros le pidamos. Sin embargo, si no somos lo suficientemente claros y precisos, R no hará lo que le pidamos y nos dará algún mensaje de error de algún tipo. Y aceptémoslo, más temprano que tarde cometeremos un error de escritura en R, el cual será el inicio de muchos errores en el camino que emprendamos en el análisis de datos a través del uso de R. Este es solo un recordatorio amigable que no debemos sentirnos mal cuando cometamos un error en R. Esto también es una señal de que estamos avanzando y aprendiendo. 

## Funciones en R 

Uno de los elementos más útiles en R al realizar análisis de datos es la utilización de funciones. En esta subsección, revisaremos algunos elementos básicos de las funciones y más adelante veremos cómo podemos empezar a definir funciones. En el inicio del capítulo 3 vimos un ejemplo de función aplicada a una variable (es decir, `sqrt(x)`).  En ese ejemplo, usamos una de las funciones bases de R para obtener la raíz cuadrada de 16 que estaba almacenada en `x`. Obviamente, podemos obtener el mismo resultado aplicando dicha función a la siguiente expresión numérica (abajo muestro nuevamente la aplicación de la función a una variable, como recordatorio):

```{r class.source="bg-danger", class.output="bg-warning"}
sqrt(16)
```
```{r class.source="bg-danger", class.output="bg-warning"}
x <- 16
sqrt(x)
```

En vez de estar escribiendo una fórmula matemática en R para la raíz cuadrada, podemos usar esta función para obtener nuestro resultado a un valor determinado (ya sea un número o una variable como en los ejemplos de arriba). Ahora, aprovecharemos de explicar algunos términos técnicos para este caso. Usualmente, cuando aplicamos una función en R, decimos que *llamaremos* (*calling*) dicha función y todos aquellos valores que escribamos dentro de la función (es decir, dentro del paréntesis), son referidos como *argumentos* (*arguments*). Y la respuesta es sí, podemos escribir más de un argumento en una función. 


### Argumentos, sus Nombres y Valores por Defecto en las Funciones

Arriba ya adelantamos que al interior de las funciones se pueden escribir argumentos y voy a recalcar el plural aquí. Dentro del paréntesis de las funciones, se pueden distinguir el *nombre de los argumentos* y sus *valores por defecto*. Para explicar estos conceptos, introduciremos una nueva función `round()`, la cual tiene por objetivo redondear un valor hacia el número entero más cercano. Veamos un ejemplo con el famoso número pi: 

```{r class.source="bg-danger", class.output="bg-warning"}
round(3.141592)
```

En este ejemplo, podemos claramente darnos cuenta que el número aproximado corresponde al 3 (y no al 4 que está mucho más lejos en la recta numérica). Ahora supongamos que queremos redondear nuestro número a 2 dígitos. Para esto, podemos escribir: 

```{r class.source="bg-danger", class.output="bg-warning"}
round(3.141592, 2)
```
En esta expresión, tenemos 2 argumentos al interior de la función `round`: el primer argumento que corresponde al valor a ser redondeado (es decir, 3.141592) y el segundo argumento es el número de decimales a aproximar (es decir, 2) y, ambos, están separados por una coma. Si notaron sagazmente, cuando escribimos `round(3.141592)` en el primer caso, no hubo un segundo argumento en la función, por lo que R asumió el argumento por defecto. Al no estar escrito, asumió que estábamos buscando redondear al valor entero más cercano sin decimales, así que allí fue completado con el número 0 el cual es el *valor por defecto* para esta función en R. Sin embargo, en el segundo caso, nosotros escribimos explícitamente un argumento (es decir, `2`) en la segunda posición de la función. De este modo, nosotros utilizamos la segunda posición de los argumentos de la función para definir el número de decimales a aproximar. Sin embargo, si queremos estar seguros de pasar el valor correcto al argumento de la función `round`, podemos escribir el o los nombres de los argumentos (es decir, `x` y `digits`). Esto quedará mucho más claro en el siguiente ejemplo:

```{r class.source="bg-danger", class.output="bg-warning"}
round(x = 3.141592, digits = 2)
```
De esta manera, no cabe ningún tipo de ambigüedades para los valores utilizados ya que han sido asignados bajo el nombre de los argumentos en conjunto con el símbolo `=`. Al mismo tiempo, al usar esta forma de pasar los argumentos al interior de la función, da lo mismo la posición de los nombres de los argumentos: obtendremos el mismo resultado, como lo muestra el siguiente ejemplo:

```{r class.source="bg-danger", class.output="bg-warning"}
round(digits = 2, x = 3.141592)
```

Pero vale la pena recalcar que si no utilizamos los nombres de los argumentos al interior de la función, debemos respetar en qué posición son asignados los valores como lo vimos en los ejemplos de más arriba (en el caso de la función `round`, primero se debe poner el valor a redonderar, luego coma y el valor de los decimales a redondear). 
